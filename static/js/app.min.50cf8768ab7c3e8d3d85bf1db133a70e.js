/*! project-staffing 2014-11-02 */

!function(){"use strict";angular.module("project-staffing",["ngRoute","ngAutocomplete","employee-directives","ngAnimate"])}(),function(){"use strict";angular.module("project-staffing").controller("AddressController",["$http","$scope","$location",function(a,b,c){var d=c.protocol()+"://"+c.host()+":"+c.port();b.result="",b.details={},b.options={},b.form={type:"geocode",watchEnter:!0},this.saveAddress=function(c){var e=Object.keys(b.details.geometry.location);c.homeaddress={},c.homeaddress.longitude=b.details.geometry.location[e[0]],c.homeaddress.latitude=b.details.geometry.location[e[1]],a.post(d+"/api/mongo/employees/"+c._id,JSON.stringify(c));var f="max",g="updated the address of an existing employee ",h={timestamp:new Date,subject:f,action:g,object:c.name};a.post(d+"/api/mongo/activities",JSON.stringify(h))}}])}(),function(){"use strict";angular.module("project-staffing").controller("CustomerController",["$http","$scope","$location",function(a,b,c){function d(){var a={zoom:9,center:h,mapTypeId:google.maps.MapTypeId.ROADMAP},b=new google.maps.Map(document.getElementById("map-canvas"),a);if(g){var c={strokeColor:"#4CC417",strokeOpacity:.8,strokeWeight:2,fillColor:"#4CC417",fillOpacity:.35,map:b,center:h,radius:5e4};new google.maps.Circle(c),new google.maps.Marker({position:h,map:b,title:"Found Address"})}var d,e,f,k=new google.maps.InfoWindow;for(e=0;e<j.length;e++)f=j[e],d=new google.maps.Marker({position:new google.maps.LatLng(f.companyaddress.longitude,f.companyaddress.latitude),map:b,icon:i,title:f.company}),google.maps.event.addListener(d,"click",function(a,c){return function(){var d=j[c],e='<p><b id="customerTitle">'+d.company+'</b></p><table class="table"><tr><tr><td><span class="label label-primary">Industry</span></td><td>'+d.industry+'</td></tr><tr><td><span class="label label-primary">Address</span></td><td>'+d.address+"</td></tr></table>";k.setContent(e),k.open(b,a)}}(d,e))}var e=c.protocol()+"://"+c.host()+":"+c.port(),f=this;f.customers=[];var g=!1;this.customer={},b.details={},b.options={},b.form={type:"geocode",watchEnter:!0},a.get(e+"/api/mongo/customers").success(function(a){f.customers=a}),this.addCustomer=function(){this.customer.companyaddress={};var c=Object.keys(b.details.geometry.location);this.customer.companyaddress.longitude=b.details.geometry.location[c[0]],this.customer.companyaddress.latitude=b.details.geometry.location[c[1]];var d="jon",g="created a new customer",h={timestamp:new Date,subject:d,action:g,object:this.customer.company};a.post(e+"/api/mongo/customers",JSON.stringify(this.customer)),a.post(e+"/api/mongo/activities",JSON.stringify(h)),a.get(e+"/api/mongo/customers").success(function(a){f.customers=a})},this.deleteCustomer=function(b){var c;for(var d in f.customers)f.customers[d]._id===b&&(c=f.customers[d],f.customers.splice(d,1));a.delete(e+"/api/mongo/customers/"+b);var g="julia",h="deleted customer",i={timestamp:new Date,subject:g,action:h,object:c.company};a.post(e+"/api/mongo/activities",JSON.stringify(i))},this.editCustomer=function(a){for(var b in f.customers)f.customers[b]._id===a&&(this.customer=f.customers[b])},this.resetForm=function(){this.customer={}};var h={lat:51.161295,lng:7.010175000000004},i={url:"img/company-icon.png",size:new google.maps.Size(64,64),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(0,64)};b.details={};var j=[];g=!1,this.searchCustomers=function(){b.details.geometry&&(h=b.details.geometry.location,g=!0);var c=e+"/api/mongo/customers";a.get(c).success(function(a){j=a,d()})},google.maps.event.addDomListener(window,"load",d)}])}(),function(){"use strict";angular.module("project-staffing").controller("DashboardController",["$http","$location",function(a,b){var c=b.protocol()+"://"+b.host()+":"+b.port(),d=this;d.employees=[],d.latestprojects=[];var e=[["Lat","Long","Office","Revenue","No. Employees","Utilization"],[51.1672852,7.0626139,"Solingen",{v:12,f:"12.0%"},0,85],[51.2111382,6.7822516,"Düsseldorf",{v:7.3,f:"7.3%"},0,65],[48.1368364,11.5234671,"München",{v:3.6,f:"3.6%"},0,75],[52.5083545,13.3771307,"Berlin",{v:2.1,f:"2.1%"},0,86],[49.00367,8.36476,"Karlsruhe",{v:5.4,f:"5.4%"},0,40],[50.0779865,8.6246555,"Frankfurt",{v:3.1,f:"3.1%"},0,55],[53.55539,9.98492,"Hamburg",{v:2.5,f:"2.5%"},0,30],[51.4969802,11.9688029,"Halle (Saale)",{v:-5.1,f:"5.1%"},0,20]];a.get(c+"/api/mongo/search/location/employees").success(function(a){d.employees=a;for(var b in e){var c=e[b][2];for(var f in d.employees)if(d.employees[f]._id===c){var g=d.employees[f].total;e[b][4]=g}}var h=google.visualization.arrayToDataTable(e),i=new google.visualization.DataView(h);i.setColumns([0,1]);var j=new google.visualization.DataView(h);j.setColumns([2,3,4,5]);var k=new google.visualization.Table(document.getElementById("table_div")),l=new google.visualization.ArrowFormat;l.format(h,3);var m=new google.visualization.BarFormat({width:150,min:0,max:100});m.format(h,5),k.draw(j,{showRowNumber:!1,allowHtml:!0});var n={mapType:"normal",showTip:!1,enableScrollWheel:!0},o=new google.visualization.Map(document.getElementById("map_div"));o.draw(i,n),google.visualization.events.addListener(k,"select",function(){o.setSelection(k.getSelection())}),google.visualization.events.addListener(o,"select",function(){k.setSelection(o.getSelection())})}),a.get(c+"/api/mongo/search/employees/latestproject").success(function(a){d.latestprojects=a;var b=new google.visualization.DataTable;b.addColumn("string","Name"),b.addColumn("string","Office"),b.addColumn("string","Project Name"),b.addColumn("date","Start"),b.addColumn("date","End"),b.addColumn("number","Idle since (days)");for(var c in d.latestprojects){var e=d.latestprojects[c],f=Math.ceil((new Date(e.projects.end)-new Date)/864e5);b.addRow([e.name,e.office,e.projects.name,new Date(e.projects.start),new Date(e.projects.end),f])}var g=new google.visualization.ColorFormat;g.addRange(-1e5,-15,"white","red"),g.addRange(-14,0,"white","orange"),g.addRange(1,60,"black","yellow"),g.addRange(61,1e5,"white","green"),g.format(b,5);var h=new google.visualization.DateFormat({pattern:"yyyy-MM-dd"});h.format(b,3),h.format(b,4);var i=new google.visualization.Table(document.getElementById("latestprojects_div"));i.draw(b,{showRowNumber:!1,allowHtml:!0,sortColumn:4})})}])}(),function(){"use strict";angular.module("project-staffing").controller("EmployeeController",["$http","$location",function(a,b){var c=b.protocol()+"://"+b.host()+":"+b.port(),d=this;this.tab=1,this.employees=d.employees,this.employee={},d.employees=[],a.get(c+"/api/mongo/employees").success(function(a){d.employees=a}),this.showTabs=function(){return void 0===this.employee._id?!1:!0},this.editEmployee=function(a){for(var b in this.employees)this.employees[b]._id===a&&(this.employee=this.employees[b])},this.resetForm=function(){this.employee={}},this.addEmployee=function(){void 0===this.employee._id?a.post(c+"/api/mongo/employees",JSON.stringify(this.employee)):a.post(c+"/api/mongo/employees/"+this.employee._id,JSON.stringify(this.employee));var b="jon",e="added a new employee",f={timestamp:new Date,subject:b,action:e,object:this.employee.name};a.post(c+"/api/mongo/activities",JSON.stringify(f)),a.get(c+"/api/mongo/employees").success(function(a){d.employees=a})},this.deleteEmployee=function(b){a.delete(c+"/api/mongo/employees/"+b);var d;for(var e in this.employees)this.employees[e]._id===b&&(d=this.employees[e],this.employees.splice(e,1));var f="max",g="deleted a employee",h={timestamp:new Date,subject:f,action:g,object:d.name};a.post(c+"/api/mongo/activities",JSON.stringify(h))}}])}(),function(){"use strict";angular.module("project-staffing").controller("NavigationController",["$scope",function(a){a.active="",a.set=function(b){a.active=b}}])}(),function(){"use strict";angular.module("project-staffing").controller("ProjectController",["$http","$location",function(a,b){var c=b.protocol()+"://"+b.host()+":"+b.port();this.deleteProject=function(b,d){d.projects.splice(b,1),a.post(c+"/api/mongo/employees/"+d._id+"/projects",JSON.stringify(d));var e="julia",f="deleted a project",g={timestamp:new Date,subject:e,action:f,object:d.projects[b].name};a.post(c+"/api/mongo/activities",JSON.stringify(g))},this.addProject=function(b){null==b.projects&&(b.projects=[]),b.projects.push(this.project),a.post(c+"/api/mongo/employees/"+b._id+"/projects",JSON.stringify(b)),this.project={};var d="maria",e="added a new project",f={timestamp:new Date,subject:d,action:e,object:this.project.name};a.post(c+"/api/mongo/activities",JSON.stringify(f))}}])}(),function(){"use strict";angular.module("project-staffing").controller("SkillController",["$http","$location",function(a,b){var c=b.protocol()+"://"+b.host()+":"+b.port();this.skill="",this.deleteSkill=function(b,d){d.skills.splice(b,1),a.post(c+"/api/mongo/employees/"+d._id+"/skills",JSON.stringify(d));var e="julia",f="deleted skill",g={timestamp:new Date,subject:e,action:f,object:d.skills[b]};a.post(c+"/api/mongo/activities",JSON.stringify(g))},this.addSkill=function(b){for(var d in b.skills)if(d===this.skill)return;if(null==b.skills&&(b.skills=[]),this.skill.length>0){b.skills.push(this.skill),a.post(c+"/api/mongo/employees/"+b._id+"/skills",JSON.stringify(b));var e="jon",f="added skill",g={timestamp:new Date,subject:e,action:f,object:this.skill};a.post(c+"/api/mongo/activities",JSON.stringify(g)),this.skill=""}}}])}(),function(){"use strict";angular.module("project-staffing").controller("StaffingController",["$http","$scope","$filter","$location",function(a,b,c,d){function e(){var a={zoom:9,center:g,mapTypeId:google.maps.MapTypeId.ROADMAP},b=new google.maps.Map(document.getElementById("map-canvas"),a);if(j){var d={strokeColor:"#4CC417",strokeOpacity:.8,strokeWeight:2,fillColor:"#4CC417",fillOpacity:.35,map:b,center:g,radius:5e4};new google.maps.Circle(d),new google.maps.Marker({position:g,map:b,title:"Selected Customer"})}var e,f,k,l=new google.maps.InfoWindow;for(f=0;f<i.length;f++)k=i[f],e=new google.maps.Marker({position:new google.maps.LatLng(k.homeaddress.longitude,k.homeaddress.latitude),map:b,icon:h,title:k.name}),google.maps.event.addListener(e,"click",function(a,d){return function(){var e=i[d],f="<p><b>"+e.name+"</b></p>";if(e.skills){f+='<p><span class="label label-success">Skills</span><table class="table"><tr><td>';for(var g=0;g<e.skills.length;g++)f+=e.skills[g]+", ";f=f.slice(0,-2),f+="</td></tr></table></p>"}else f+="<br>No skills.";if(e.projects){f+='<p><span class="label label-success">Projects</span><table class="table">',e.projects.sort(function(a,b){return a.start<b.start?1:0});for(var h=0;h<e.projects.length;h++){var j=e.projects[h].start,k=e.projects[h].end;void 0===k&&(k="Current");var m=e.projects[h].name;f+='<tr><td><span class="label label-primary">'+c("date")(j,"yyyy-MM-dd")+"</span></td>",f+='<td><span class="label label-info">'+c("date")(k,"yyyy-MM-dd")+"</span></td><td>"+m+"</td></tr>"}f+="</table></p>"}else f+="<br>No projects.";l.setContent(f),l.open(b,a)}}(e,f))}var f=d.protocol()+"://"+d.host()+":"+d.port(),g={lat:51.161295,lng:7.010175000000004},h={url:"img/default-face.png",size:new google.maps.Size(64,64),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(0,64)};b.details={},b.skillQuery="";var i=[],j=!1;this.searchCustomer=function(){if(b.details.geometry){var c=Object.keys(b.details.geometry.location);g.lat=b.details.geometry.location[c[0]],g.lng=b.details.geometry.location[c[1]],j=!0}var d=f+"/api/mongo/employees";if(b.skillQuery){for(var h=b.skillQuery.toLowerCase().split(","),k="",l=0;l<h.length;l++){var m=h[l].trim();k+="&skills="+m}d=f+"/api/mongo/search/employees/skills?"+k}a.get(d).success(function(a){i=a,e()})},google.maps.event.addDomListener(window,"load",e)}])}(),function(){"use strict";angular.module("project-staffing").controller("TimelineController",["$http","$location",function(a,b){var c=b.protocol()+"://"+b.host()+":"+b.port(),d=this;d.list=[],a.get(c+"/api/mongo/activities").success(function(a){d.list=a})}])}(),function(){"use strict";var a=angular.module("employee-directives",[]);a.directive("navigation",function(){return{restrict:"E",templateUrl:"navigation.html"}}),a.directive("employeeTable",function(){return{restrict:"E",templateUrl:"employee-table.html"}}),a.directive("employeeList",function(){return{restrict:"E",templateUrl:"employee-list.html"}}),a.directive("employeeForm",function(){return{restrict:"E",templateUrl:"employee-form.html"}}),a.directive("skillForm",function(){return{restrict:"E",templateUrl:"skill-form.html"}}),a.directive("projectForm",function(){return{restrict:"E",templateUrl:"project-form.html"}}),a.directive("homeaddressForm",function(){return{restrict:"E",templateUrl:"homeaddress-form.html"}}),a.directive("searchaddressForm",function(){return{restrict:"E",templateUrl:"searchaddress-form.html"}}),a.directive("customerTable",function(){return{restrict:"E",templateUrl:"customer-table.html"}}),a.directive("searchCustomerAddressForm",function(){return{restrict:"E",templateUrl:"searchcustomeraddress-form.html"}})}(),function(){"use strict";angular.module("project-staffing").filter("firstLetterUppercase",function(){return function(a){if(0===a.length)return"";for(var b=a.split(/[ ]+/),c="",d=0;d<b.length;d++)c+=b[d].charAt(0).toUpperCase()+b[d].slice(1)+" ";return c.trim()}})}(),angular.module("ngAutocomplete",[]).directive("ngAutocomplete",function(){return{require:"ngModel",scope:{ngModel:"=",options:"=?",details:"=?"},link:function(a,b,c,d){var e,f=!1,g=function(){e={},a.options&&(f=a.options.watchEnter!==!0?!1:!0,a.options.types?(e.types=[],e.types.push(a.options.types),a.gPlace.setTypes(e.types)):a.gPlace.setTypes([]),a.options.bounds?(e.bounds=a.options.bounds,a.gPlace.setBounds(e.bounds)):a.gPlace.setBounds(null),a.options.country?(e.componentRestrictions={country:a.options.country},a.gPlace.setComponentRestrictions(e.componentRestrictions)):a.gPlace.setComponentRestrictions(null))};void 0==a.gPlace&&(a.gPlace=new google.maps.places.Autocomplete(b[0],{})),google.maps.event.addListener(a.gPlace,"place_changed",function(){var c=a.gPlace.getPlace();void 0!==c&&(void 0!==c.address_components?a.$apply(function(){a.details=c,d.$setViewValue(b.val())}):f&&h(c))});var h=function(c){var e=new google.maps.places.AutocompleteService;c.name.length>0&&e.getPlacePredictions({input:c.name,offset:c.name.length},function(c){if(null==c||0==c.length)a.$apply(function(){a.details=null});else{var e=new google.maps.places.PlacesService(b[0]);e.getDetails({reference:c[0].reference},function(c,e){e==google.maps.GeocoderStatus.OK&&a.$apply(function(){d.$setViewValue(c.formatted_address),b.val(c.formatted_address),a.details=c;b.on("focusout",function(){b.val(c.formatted_address),b.unbind("focusout")})})})}})};d.$render=function(){var a=d.$viewValue;b.val(a)},a.watchOptions=function(){return a.options},a.$watch(a.watchOptions,function(){g()},!0)}}}),function(){"use strict";angular.module("project-staffing").config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/index.html"}).when("/timeline",{templateUrl:"views/timeline.html",controller:"TimelineController",controllerAs:"timelineCtrl"}).when("/dashboard",{templateUrl:"views/dashboard.html",controller:"DashboardController",controllerAs:"dashboardCtrl"}).when("/list-employees",{templateUrl:"views/list_employees.html",controller:"EmployeeController",controllerAs:"employeeCtrl"}).when("/add-employee",{templateUrl:"views/add_employee.html",controller:"EmployeeController",controllerAs:"employeeCtrl"}).when("/list-customers",{templateUrl:"views/list_customers.html",controller:"CustomerController",controllerAs:"customerCtrl"}).when("/staffing",{templateUrl:"views/staff_project.html",controller:"StaffingController",controllerAs:"staffingCtrl"}).when("/add-customer",{templateUrl:"views/add_customer.html",controller:"CustomerController",controllerAs:"customerCtrl"}).when("/help",{templateUrl:"views/help.html"}).otherwise({redirectTo:"/"})}])}();
//# sourceMappingURL=app.min.js.map